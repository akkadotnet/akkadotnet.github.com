<!DOCTYPE html>
<!--[if IE 8]>			<html class="ie ie8"> <![endif]-->
<!--[if IE 9]>			<html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->	<html> <!--<![endif]-->
	<head>
		

<meta charset="utf-8" />
<title>Dispatchers | Akka.NET</title>

<meta name="keywords" content="Actor,Finite state machine, concurrency" />
<meta name="description" content="" />
<meta name="Author" content="Dorin Grigoras [www.stepofweb.com]" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<!-- mobile settings -->
<meta name="viewport" contenht="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0" />

<!-- Favicon -->
<link rel="shortcut icon" href="/theme_assets/images/demo/favicon.ico" />

<!-- WEB FONTS -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css" />

<!-- CORE CSS -->
<link href="/theme_assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/font-awesome.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/sky-forms.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/weather-icons.min.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/line-icons.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/plugins/owl-carousel/owl.pack.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/plugins/magnific-popup/magnific-popup.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/animate.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/flexslider.css" rel="stylesheet" type="text/css" />

<!-- FAV ICON -->
<link rel="shortcut icon" href="http://akkadotnet.github.io/favicon.ico?v=2" />

<!-- REVOLUTION SLIDER -->
<link href="/theme_assets/css/revolution-slider.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/layerslider.css" rel="stylesheet" type="text/css" />

<!-- BLOG -->
<link href="/theme_assets/css/layout-blog.css" rel="stylesheet" type="text/css" />

<!-- THEME CSS -->
<link href="/theme_assets/css/essentials.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/layout.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/header-default.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/footer-default.css" rel="stylesheet" type="text/css" />
<link href="/theme_assets/css/color_scheme/red.css" rel="stylesheet" type="text/css" id="color_scheme" />

<!-- Highlighting -->
<link href="https://highlightjs.org/static/demo/styles/github.css" rel="stylesheet" type="text/css" />
<link href="/css/screen.css" rel="stylesheet" type="text/css" />

<!-- Modernizr -->
<script type="text/javascript" src="/theme_assets/plugins/modernizr.min.js"></script>

<!--[if lte IE 8]>
  <script src="/theme_assets/plugins/respond.js"></script>
<![endif]-->

	</head>

	<!--
		Available body classes:
			smoothscroll			= enable chrome browser smooth scroll
			grey 					= grey content background
			boxed 					= boxed style
			pattern1 ... pattern10 	= background pattern

		Background Image - add to body:
			data-background="/theme_assets/images/boxed_background/1.jpg"
	-->
	<body class=" ">

		<div id="wrapper">
			<div id="header">
  <header id="topBar">
    <div class="container">

      

      <!-- Logo -->
      <a class="logo" href="/">
        <img src="/images/akkalogo.png"  alt="" style="padding-top:0px;padding-left: 5px;" />
      </a>

    </div><!-- /.container -->
  </header>
  <div id="topNav">
  <div class="container">
    <!-- Mobile Menu Button -->
    <button class="btn btn-mobile" data-toggle="collapse" data-target=".nav-main-collapse">
      <i class="fa fa-bars"></i>
    </button>

    <!-- Search -->
    <form class="search" method="get" action="/search">
      <input type="text" class="form-control" name="q" value="" placeholder="Search">
      <button class="fa fa-search"></button>
    </form>
    <!-- /Search -->

    <!-- Top Nav -->
    <div class="navbar-collapse nav-main-collapse collapse inline-block">
      <nav class="nav-main">

      

        <!-- pageurl  -->
        <ul id="topMain" class="nav nav-pills nav-main">
          <li class="mega-menu  active">
            <a href="/docs/">DOCUMENTATION<span>&nbsp;</span></a>
          </li>
          <li class="mega-menu">
            <a href="https://github.com/akkadotnet/akka.net/">CODE<span>&nbsp;</span></a>
          </li>
          <li class="mega-menu">
            <a href="https://gitter.im/akkadotnet/akka.net">PROJECT CHAT<span>&nbsp;</span></a>
          </li>
          <li class="mega-menu">
            <a href="https://groups.google.com/forum/#!forum/akkadotnet-user-list">MAILING LIST<span>&nbsp;</span></a>
          </li>
          <li class="mega-menu ">
            <a href="/pages/support">COMMERCIAL SUPPORT<span>&nbsp;</span></a>
          </li>
          <li class="mega-menu ">
            <a href="/docs/Resources">RESOURCES<span>&nbsp;</span></a>
          </li>
        </ul>

      </nav>
    </div>
</div>
</div>
			

			<!-- PAGE TOP -->
			<section class="page-title">
				<div class="container">
					<header>
						<ul class="breadcrumb"><!-- breadcrumb -->
							<li><a href="/">Home</a></li>
							<li><a href="/docs/">Docs</a></li>
							<li class="active">Dispatchers<a href="https://github.com/akkadotnet/getakka.net/edit/master/src/docs/Dispatchers.md" > (Edit on Github)</a></li>
						</ul><!-- /breadcrumb -->

						<h2><!-- Page Title -->
							<strong>Akka.NET</strong> Docs
						</h2><!-- /Page Title -->

					</header>

				</div>
			</section>
			<!-- /PAGE TOP -->

			<!-- CONTENT -->
			<section>
				<div class="container">

					<div class="row">

						<!-- RIGHT COLUMNS -->
						<div class="col-md-3" id="toc">
						</div>
						<!-- /RIGHT COLUMNS -->

						<!-- LEFT COLUMNS -->
						<div class="col-md-8 docs-content">
							<div id="main_content">

								<div><h1 id="dispatchers">Dispatchers</h1>
<h2 id="what-do-dispatchers-do-">What Do Dispatchers Do?</h2>
<p>Dispatchers are responsible for scheduling all code that run inside the <code>ActorSystem</code>. Dispatchers are one of the most important parts of Akka.NET, as they control the throughput and time share for each of the actors, giving each one a fair share of resources.</p>
<p>By default, all actors share a single <strong>Global Dispatcher</strong>. Unless you change the configuration, this dispatcher uses the <em>.NET Thread Pool</em> behind the scenes, which is optimized for most common scenarios. <strong>That means the default configuration should be <em>good enough</em> for most cases.</strong></p>
<h4 id="why-should-i-use-different-dispatchers-">Why should I use different dispatchers?</h4>
<p>When messages arrive in the <a href="Mailbox">actor&#39;s mailbox</a>, the dispatcher schedules the delivery of messages in batches, and tries to deliver the entire batch before releasing the thread to another actor. While the default configuration is <em>good enough</em> for most scenarios, you may want to change (<a href="#configuring-dispatchers">through configuration</a>) how much time the scheduler should spend running each actor.</p>
<p>There are some other common reasons to select a different dispatcher. These reasons include (but are not limited to):</p>
<ul>
<li>isolating one or more actors to specific threads in order to:<ul>
<li>ensure high-load actors don&#39;t starve the system by consuming too much cpu-time;</li>
<li>ensure important actors always have a dedicated thread to do their job;</li>
<li>create <a href="http://skife.org/architecture/fault-tolerance/2009/12/31/bulkheads.html">bulkheads</a>, ensuring problems created in one part of the system do not leak to others;</li>
</ul>
</li>
<li>allow actors to execute in a specific SyncrhonizationContext;</li>
</ul>
<div class="alert alert-default">
<p><strong>Note:</strong> Consider using custom dispatchers for special cases only. Correctly configuring dispatchers requires some understanding of how the framework works. Custom dispatchers <em>should not</em> be considered the default solution for performance problems. It&#39;s considered normal for complex applications to have one or a few custom dispatchers, it&#39;s not usual for most or all actors in a system to require a custom dispatcher configuration.</p>
</div>
<h2 id="dispatchers-vs-dispatcher-configurations">Dispatchers vs. Dispatcher Configurations</h2>
<p>Throughout this documentation and most Akka literature available, the term <em>dispatcher</em> is used to refer to <em>dispatcher configurations</em>, but they are in fact different things.</p>
<ul>
<li><p><strong>Dispatchers</strong> are low level components that are responsible for scheduling code execution in the system. These components are built into Akka.NET, there is a fixed number of them and you don&#39;t need to create or change them.</p>
</li>
<li><p><strong>Dispatcher Configurations</strong> are custom settings you can create to <em>make use of dispatchers</em> in specific ways. There are some built-in dispatcher configurations, and you can create as many as you need for your applications.</p>
</li>
</ul>
<p>Therefore, when you read about <em>&quot;creating a custom dispatcher&quot;</em> it usually means &quot;<em>using a custom configuration for one of the built-in dispatchers</em>&quot;.</p>
<h2 id="configuring-dispatchers">Configuring Dispatchers</h2>
<p>You can define a custom dispatcher configuration using a HOCON configuration section.</p>
<p>The example below creates a custom dispatcher called <code>my-dispatcher</code> that can be set in one or more actors during deployment:</p>
<pre><code class="hljs lang-hocon"><span class="hljs-keyword">my</span>-dispatcher {
    type = Dispatcher
    throughput = <span class="hljs-number">100</span>
    throughput-deadline-<span class="hljs-property">time</span> = <span class="hljs-number">0</span>ms
}
</code></pre>
<p>You can then set actor&#39;s dispatcher using the deployment configuration:</p>
<pre><code class="hljs lang-hocon">akka.actor.deployment {
    /<span class="hljs-keyword">my</span>-actor {
        dispatcher = <span class="hljs-keyword">my</span>-dispatcher
    }
}
</code></pre>
<p>Or you can also set it up in code:</p>
<pre><code class="hljs lang-cs">system.ActorOf(Props.Create&lt;MyActor&gt;().WithDispatcher(<span class="hljs-string">"my-dispatcher"</span>), <span class="hljs-string">"my-actor"</span>);
</code></pre>
<h4 id="built-in-dispatcher-configurations">Built-in Dispatcher Configurations</h4>
<p>Some dispatcher configurations are available out-of-the-box for convenience. You can use them during actor deployment, <a href="#configuring-dispatchers">as described above</a>.</p>
<ul>
<li><strong>default-dispatcher</strong> - A configuration that uses the <a href="#ThreadPoolDispatcher">ThreadPoolDispatcher</a>. As the name says, this is the default dispatcher configuration used by the global dispatcher, and you don&#39;t need to define anything during deployment to use it.</li>
<li><strong>task-dispatcher</strong> - A configuration that uses the <a href="#TaskDispatcher">TaskDispatcher</a>.</li>
<li><strong>default-fork-join-dispatcher</strong> - A configuration that uses the [ForkJoinDispatcher].</li>
<li><strong>synchronized-dispatcher</strong> - A configuration that uses the <a href="#SynchronizedDispatcher">SynchronizedDispatcher</a>.</li>
</ul>
<h2 id="built-in-dispatchers">Built-in Dispatchers</h2>
<p>These are the underlying dispatchers built-in to Akka.NET:</p>
<ul>
<li><h3 id="threadpooldispatcher">ThreadPoolDispatcher</h3>
<p>It schedules code to run in the <a href="https://msdn.microsoft.com/en-us/library/System.Threading.ThreadPool.aspx">.NET Thread Pool</a>, which is <strong><em>good enough</em> for most cases.</strong></p>
<p>The <code>type</code> used in the HOCON configuration for this dispatcher is just <code>Dispatcher</code>.</p>
<pre><code class="hljs lang-hocon"><span class="hljs-title">custom</span>-dispatcher {
  <span class="hljs-typedef"><span class="hljs-keyword">type</span> = <span class="hljs-type">Dispatcher</span></span>
  throughput = <span class="hljs-number">100</span>
}
</code></pre>
<div class="alert alert-default">
<p><strong>Note:</strong> While each configuration can have it&#39;s own throughput settings, all dispatchers using this type will run in the same default .NET Thread Pool.</p>
</div>
</li>
<li><h3 id="taskdispatcher">TaskDispatcher</h3>
<p>The TaskDispatcher uses the <a href="https://msdn.microsoft.com/en-us/library/dd460717.aspx">TPL</a> infrastructure to schedule code execution. This dispatcher is very similar to the Thread PoolDispatcher, but may be used in some rare scenarios where the thread pool isn&#39;t available.</p>
<pre><code class="hljs lang-hocon"><span class="hljs-title">custom</span>-task-dispatcher {
    <span class="hljs-typedef"><span class="hljs-keyword">type</span> = <span class="hljs-type">TaskDispatcher</span></span>
    throughput = <span class="hljs-number">100</span>
}
</code></pre>
</li>
<li><h3 id="pinneddispatcher">PinnedDispatcher</h3>
<p>The <code>PinnedDispatcher</code> uses a single dedicated thread to schedule code executions. Ideally, this dispatcher should be using sparingly.</p>
<pre><code class="hljs lang-hocon"><span class="hljs-title">custom</span>-dedicated-dispatcher {
    <span class="hljs-typedef"><span class="hljs-keyword">type</span> = <span class="hljs-type">PinnedDispatcher</span></span>
}
</code></pre>
</li>
<li><h3 id="forkjoindispatcher">ForkJoinDispatcher</h3>
<p>The ForkJoinDispatcher uses a dedicated threadpool to schedule code execution. You can use this scheduler isolate some actors from the rest of the system. Each dispatcher configuration will have it&#39;s own thread pool.</p>
<p>This is the configuration for the <a href="#built-in-dispatcher-configurations"><em>default-fork-join-dispatcher</em></a>.  You may use this as example for custom fork-join dispatchers.</p>
<pre><code class="hljs lang-hocon"><span class="hljs-keyword">default</span>-fork-join-dispatcher {
    type = ForkJoinDispatcher
    throughput = <span class="hljs-number">100</span>
    dedicated-thread-pool {
        thread-count = <span class="hljs-number">3</span>
        deadlock-timeout = <span class="hljs-number">3</span>s
        threadtype = background
    }
}
</code></pre>
<ul>
<li><code>thread-count</code> - The number of threads dedicated to this dispatcher.</li>
<li><code>deadlock-timeout</code> - The amount of time to wait before considering the thread as deadlocked. By default no timeout is set, meaning code can run in the threads for as long as they need. If you set a value, once the timeout is reached the thread will be aborted and a new threads will take it&#39;s place. Set this value carefully, as very low values may cause loss of work.</li>
<li><code>threadtype</code> - Must be <code>background</code> or <code>foreground</code>. This setting helps define <a href="https://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx">how .NET handles</a> the thread.</li>
</ul>
</li>
<li><h3 id="synchronizeddispatcher">SynchronizedDispatcher</h3>
<p>The <code>SynchronizedDispatcher</code> uses the <em>current</em> <a href="https://msdn.microsoft.com/en-us/magazine/gg598924.aspx">SynchronizationContext</a> to schedule executions.</p>
<p>You may use this dispatcher to create actors that update UIs in a reactive manner. An application that displays real-time updates of stock prices may have a dedicated actor to update the UI controls directly for example.</p>
<div class="alert alert-default">
<p><strong>Note:</strong> As a general rule, actors running in this dispatcher shouldn&#39;t do much work. Avoid doing any extra work that may be done by actors running in other pools.</p>
</div>
<p>This is the configuration for the <a href="#built-in-dispatcher-configurations"><em>synchronized-dispatcher</em></a>.  You may use this as example for custom fork-join dispatchers.</p>
<pre><code class="hljs lang-hocon">synchronized-dispatcher {
    <span class="hljs-class"><span class="hljs-keyword">type</span> </span>= <span class="hljs-string">"SynchronizedDispatcher"</span>
    throughput = <span class="hljs-number">10</span>
}
</code></pre>
<p>In order to use this dispatcher, you must create the actor from the syncrhonization context you want to run-it. For example:</p>
<pre><code class="hljs lang-cs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Form1_Load</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, System.EventArgs e</span>)
</span>{
    system.ActorOf(Props.Create&lt;UIWorker&gt;().WithDispatcher(<span class="hljs-string">"synchronized-dispatcher"</span>), <span class="hljs-string">"ui-worker"</span>);
}
</code></pre>
</li>
</ul>
<h4 id="common-dispatcher-configuration">Common Dispatcher Configuration</h4>
<p>The following configuration keys are available for any dispatcher configuration:</p>
<ul>
<li><code>type</code> - (Required) The type of dispatcher to be used: <code>Dispatcher</code>, <code>TaskDispatcher</code>, <code>PinnedDispatcher</code>, <code>ForkJoinDispatcher</code> or <code>SynchronizedDispatcher</code>.</li>
<li><code>throughput</code> - (Required) The maximum # of messages processed each time the actor is activated. Most dispatchers default to <code>100</code>.</li>
<li><code>throughput-deadline-time</code> - The maximum amount of time to process messages when the actor is activated, or <code>0</code> for no limit. The default is <code>0</code>.</li>
</ul>
<div class="alert alert-default">
<p><strong>Note:</strong> The throughput-deadline-time is used as a <em>best effort</em>, not as a <em>hard limit</em>. This means that if a message takes more time than the deadline allows, Akka.NET won&#39;t interrupt the process. Instead it will wait for it to finish before giving turn to the next actor.</p>
</div>
</div>

								

						</div>
						<div class="col-md-1">&nbsp;</div>
						<!-- /LEFT COLUMNS -->



					</div>

				</div>
			</section>
			<!-- /CONTENT -->

			<footer id="footer">
  <div class="container">
    <div class="row">
        <!-- col #1 -->
        <div class="spaced dark col-md-3">
            <h4>About <strong>Akka.NET</strong></h4>
            <p class="block">
                Akka.NET is a port of the popular
                <br/> Java/Scala framework <a href="http://akka.io">Akka</a> to .NET.
                <br/>
                <br/> This is a community driven port and
                <br/> is not affiliated with <a href="http://typesafe.com">Typesafe</a> who
                <br/> makes the original Java/Scala version.
                <br/>
            </p>
            <!-- social -->
            <p class="block">
                <a href="mailto:hi@getakka.net">hi@getakka.net</a><br>
                <a href="https://www.facebook.com/akkadotnet" class="social fa fa-facebook"></a>
                <a href="http://stackoverflow.com/questions/tagged/akka.net" class="social fa fa-stack-overflow"></a>
                <a href="https://twitter.com/AkkaDotNET" class="social fa fa-twitter"></a>
            </p><!-- /social -->
        </div>
        <!-- /col #1 -->
        <!-- col #3 -->
        <div class="spaced col-md-6 col-sm-4">
            <h4>Recent <strong>Tweets</strong></h4>
            <ul class="list-unstyled fsize13" id="recent_tweets">
            </ul>
        </div>
        <!-- /col #3 -->
        <div class="spaced col-md-3 col-sm-4">
            <h4>Keep <strong>Updated</strong></h4>
            <h4><small><strong>Subscribe to our Newsletter</strong></small></h4>
            <!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
    <form class="input-group" action="//github.us8.list-manage.com/subscribe/post?u=945d2a2edaa89aaabd396bc45&amp;id=5f9a7a993d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <input type="email" value="" name="EMAIL" class="form-control placeholder required email" id="mce-EMAIL" placeholder="E-mail Address">
        <span class="input-group-btn">
  <button class="btn btn-primary" type="submit" name="subscribe" id="mc-embedded-subscribe">SUBMIT</button>
</span>
        <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display:none"></div>
            <div class="response" id="mce-success-response" style="display:none"></div>
        </div>
        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
        <div style="position: absolute; left: -5000px;">
            <input type="text" name="b_945d2a2edaa89aaabd396bc45_5f9a7a993d" tabindex="-1" value="">
        </div>
        <div class="clear"></div>
    </form>
</div>
<!--End mc_embed_signup-->

        </div>
    </div>
  </div>
  <hr />
  <!-- <div class="copyright">
    <div class="container text-center fsize12"></div>
  </div> -->
</footer>


			<a href="#" id="toTop"></a>

		</div><!-- /#wrapper -->

		<script type="text/javascript" src="/theme_assets/plugins/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/jquery.isotope.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/masonry.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/magnific-popup/jquery.magnific-popup.min.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/owl-carousel/owl.carousel.min.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/knob/js/jquery.knob.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/flexslider/jquery.flexslider-min.js"></script>

<!-- REVOLUTION SLIDER -->
<script type="text/javascript" src="/theme_assets/plugins/revolution-slider/js/jquery.themepunch.plugins.min.js"></script>
<script type="text/javascript" src="/theme_assets/plugins/revolution-slider/js/jquery.themepunch.revolution.min.js"></script>
<script type="text/javascript" src="/theme_assets/js/revolution_slider.js"></script>
<script type="text/javascript" src="/js/jquery-toc.js"></script>
<script type="text/javascript" src="/theme_assets/js/scripts.js"></script>
<script type="text/javascript" src="/js/scripts.js"></script>
		<!-- REACTIVE MANIFESTO BANNER -->
<a href="http://www.reactivemanifesto.org/"> <img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000; max-width: 125px;" src="//d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-red-right.png"> </a>

	</body>
</html>
