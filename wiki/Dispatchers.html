<!DOCTYPE html>
<!--[if IE 8]>			<html class="ie ie8"> <![endif]-->
<!--[if IE 9]>			<html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->	<html> <!--<![endif]-->
	<head>
		<meta charset="utf-8" />
		<title> Dispatchers |  Akka.NET</title>
		<meta name="keywords" content="Actor,Finite state machine, concurrency" />
		<meta name="description" content="" />
		<meta name="Author" content="Dorin Grigoras [www.stepofweb.com]" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<!-- mobile settings -->
		<meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0" />

		<!-- Favicon -->
		<link rel="shortcut icon" href="/assets/images/demo/favicon.ico" />

		<!-- WEB FONTS -->
		<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css" />

		<!-- CORE CSS -->
		<link href="/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/font-awesome.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/sky-forms.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/weather-icons.min.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/line-icons.css" rel="stylesheet" type="text/css" />
		<link href="/assets/plugins/owl-carousel/owl.pack.css" rel="stylesheet" type="text/css" />
		<link href="/assets/plugins/magnific-popup/magnific-popup.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/animate.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/flexslider.css" rel="stylesheet" type="text/css" />

		<!-- FAV ICON -->
		<link rel="shortcut icon" href="http://akkadotnet.github.io/favicon.ico?v=2" />

		<!-- REVOLUTION SLIDER -->
		<link href="/assets/css/revolution-slider.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/layerslider.css" rel="stylesheet" type="text/css" />

		<!-- BLOG -->
		<link href="/assets/css/layout-blog.css" rel="stylesheet" type="text/css" />

		<!-- THEME CSS -->
		<link href="/assets/css/essentials.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/layout.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/header-default.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/footer-default.css" rel="stylesheet" type="text/css" />
		<link href="/assets/css/color_scheme/red.css" rel="stylesheet" type="text/css" id="color_scheme" />
		<link href="/content/style.css" rel="stylesheet" type="text/css" />
		
		<!-- Highlighting -->
		<link href="https://highlightjs.org/static/styles/monokai_sublime.css" rel="stylesheet" type="text/css" />
	
		<!-- Morenizr -->
		<script type="text/javascript" src="/assets/plugins/modernizr.min.js"></script>

		<!--[if lte IE 8]>
			<script src="/assets/plugins/respond.js"></script>
		<![endif]-->
	</head>
	
	<!-- 
		Available body classes: 
			smoothscroll			= enable chrome browser smooth scroll
			grey 					= grey content background
			boxed 					= boxed style
			pattern1 ... pattern10 	= background pattern

		Background Image - add to body: 
			data-background="/assets/images/boxed_background/1.jpg"
	-->
	<body class="smoothscroll">

		<div id="wrapper">

			<div id="header"><!-- class="sticky" for sticky menu -->

				<!-- Top Bar -->
				<header id="topBar">
					<div class="container">

						<div class="pull-right fsize13 margin-top10 hide_mobile">

							<!-- mail , phone -->
							<a href="mailto:akkadotnet@gmail.com">AkkaDotNet@Gmail.com</a> &bull; 

							<div class="block text-right"><!-- social -->
								<a href="https://www.facebook.com/akkadotnet" class="social fa fa-facebook"></a>
								<a href="http://stackoverflow.com/questions/tagged/akka.net" class="social fa fa-stack-overflow"></a>
								<a href="https://twitter.com/AkkaDotNET" class="social fa fa-twitter"></a>
							</div><!-- /social -->

						</div>

						<!-- Logo -->
						<a class="logo" href="/">
							<img src="/content/images/akkalogo.png"  alt="" style="padding-top:10px;" />
						</a>

					</div><!-- /.container -->
				</header>
				<!-- /Top Bar -->


				<!-- Top Nav -->
				<header id="topNav">
					<div class="container">

						<!-- Mobile Menu Button -->
						<button class="btn btn-mobile" data-toggle="collapse" data-target=".nav-main-collapse">
							<i class="fa fa-bars"></i>
						</button>

						<!-- Search -->
						<form class="search" method="get" action="/search">
							<input type="text" class="form-control" name="q" value="" placeholder="Search">
							<button class="fa fa-search"></button>
						</form>
						<!-- /Search -->

						<!-- Top Nav -->
						<div class="navbar-collapse nav-main-collapse collapse">
							<nav class="nav-main">

								<!--
									NOTE
									
									For a regular link, remove "dropdown" class from LI tag and "dropdown-toggle" class from the href.
									Direct Link Example: 

									<li>
										<a href="#">HOME</a>
									</li>
								-->
								
								<!-- pageurl wiki/Dispatchers -->
								<ul id="topMain" class="nav nav-pills nav-main">
									<li class="mega-menu">
										<a href="/">
											HOME <span>welcome</span>
										</a>
									</li>
									<li class="mega-menu">										
										<a href="/wiki/">DOCUMENTATION <span>Wiki</span></a>
									</li>
									<li class="mega-menu">
										<a href="https://github.com/akkadotnet/akka.net">CODE <span>Github repository</span></a>
									</li>
									<li class="mega-menu">
										<a href="https://groups.google.com/forum/?hl=sv#!forum/akkadotnet-user-list">MAILINGLIST <span>Discuss</span></a>
									</li>	
									<li class="mega-menu">
										<a href="https://github.com/akkadotnet/akka.net/issues">TRACKER <span>Issues and Features</span></a>
									</li>	
								</ul>

							</nav>
						</div>
						<!-- /Top Nav -->

					</div><!-- /.container -->
				</header>
				<!-- /Top Nav -->

			</div>

						<!-- PAGE TOP -->
			<section class="page-title">
				<div class="container">

					<header>

						<ul class="breadcrumb"><!-- breadcrumb -->
							<li><a href="/">Home</a></li>
							<li><a href="/wiki/">Wiki</a></li>
							<li class="active"> Dispatchers  <a href="https://github.com/akkadotnet/akka.net/wiki/Dispatchers/_edit"> (edit)</a></li>							
						</ul><!-- /breadcrumb -->

						<h2><!-- Page Title -->
							<strong>Akka.NET</strong> Wiki
						</h2><!-- /Page Title -->

					</header>

				</div>			
			</section>
			<!-- /PAGE TOP -->

			<!-- CONTENT -->
			<section>
				<div class="container">

					<div class="row">

						<!-- RIGHT COLUMNS -->
						<div class="col-md-3" id="toc">	
						</div>
						<!-- /RIGHT COLUMNS -->

						<!-- LEFT COLUMNS -->
						<div class="col-md-9">
							<div id="main_content">

								<h1 id="dispatchers">Dispatchers</h1>
<p>An Akka <code>MessageDispatcher</code> is what makes Akka Actors &quot;tick&quot;, it is the engine of the machine so to speak. All <code>MessageDispatcher</code> implementations are also an <code>ExecutionContext</code>, which means that they can be used to execute arbitrary code, for instance <code>Futures</code>.</p>
<h2 id="default-dispatcher">Default dispatcher</h2>
<p>Every <code>ActorSystem</code> will have a default dispatcher that will be used in case nothing else is configured for an Actor. The default dispatcher can be configured using <code>akka.actor.default-dispatcher</code>, and is by default a <code>Dispatcher</code>.</p>
<h4 id="actors-multiplexing-on-net-thread-pool">Actors multiplexing on .NET thread pool</h4>
<p><img class="img-responsive" src="https://raw.githubusercontent.com/wiki/akkadotnet/akka.net/images/ThreadMultiplex.png" alt="Thread Multiplex"></p>
<h2 id="looking-up-a-dispatcher">Looking up a Dispatcher</h2>
<p>Dispatchers implement the ExecutionContext interface and can thus be used to run Future invocations etc.</p>
<pre><code class="hljs lang-csharp">// this <span class="hljs-keyword">is</span> scala.concurrent.ExecutionContext
// <span class="hljs-keyword">for</span> use with Futures, Scheduler, etc.
ExecutionContext <span class="hljs-keyword">ex</span> = <span class="hljs-built_in">system</span>.Dispatchers.Lookup(<span class="hljs-string">"my-dispatcher"</span>);
</code></pre>
<h2 id="setting-the-dispatcher-for-an-actor">Setting the dispatcher for an Actor</h2>
<p>So in case you want to give your Actor a different dispatcher than the default, you need to do two things, of which the first is is to configure the dispatcher:</p>
<pre><code>my-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to <span class="hljs-operator"><span class="hljs-keyword">use</span>
  executor = <span class="hljs-string">"fork-join-executor"</span>
  # Configuration <span class="hljs-keyword">for</span> the fork <span class="hljs-keyword">join</span> pool
  fork-<span class="hljs-keyword">join</span>-executor {
    # <span class="hljs-keyword">Min</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> threads <span class="hljs-keyword">to</span> cap factor-based parallelism <span class="hljs-built_in">number</span> <span class="hljs-keyword">to</span>
    parallelism-<span class="hljs-keyword">min</span> = <span class="hljs-number">2</span>
    # Parallelism (threads) ... <span class="hljs-keyword">ceil</span>(available processors * factor)
    parallelism-factor = <span class="hljs-number">2.0</span>
    # <span class="hljs-keyword">Max</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> threads <span class="hljs-keyword">to</span> cap factor-based parallelism <span class="hljs-built_in">number</span> <span class="hljs-keyword">to</span>
    parallelism-<span class="hljs-keyword">max</span> = <span class="hljs-number">10</span>
  }
  # Throughput defines the maximum <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> messages <span class="hljs-keyword">to</span> be
  # processed per actor <span class="hljs-keyword">before</span> the thread jumps <span class="hljs-keyword">to</span> the <span class="hljs-keyword">next</span> actor.
  # <span class="hljs-keyword">Set</span> <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">as</span> fair <span class="hljs-keyword">as</span> possible.
  throughput = <span class="hljs-number">100</span>
}</span>
</code></pre><p>And here&#39;s another example that uses the <code>&quot;thread-pool-executor&quot;</code>:</p>
<pre><code>my-thread-pool-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to <span class="hljs-operator"><span class="hljs-keyword">use</span>
  executor = <span class="hljs-string">"thread-pool-executor"</span>
  # Configuration <span class="hljs-keyword">for</span> the thread pool
  thread-pool-executor {
    # minimum <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> threads <span class="hljs-keyword">to</span> cap factor-based core <span class="hljs-built_in">number</span> <span class="hljs-keyword">to</span>
    core-pool-<span class="hljs-keyword">size</span>-<span class="hljs-keyword">min</span> = <span class="hljs-number">2</span>
    # <span class="hljs-keyword">No</span> <span class="hljs-keyword">of</span> core threads ... <span class="hljs-keyword">ceil</span>(available processors * factor)
    core-pool-<span class="hljs-keyword">size</span>-factor = <span class="hljs-number">2.0</span>
    # maximum <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> threads <span class="hljs-keyword">to</span> cap factor-based <span class="hljs-built_in">number</span> <span class="hljs-keyword">to</span>
    core-pool-<span class="hljs-keyword">size</span>-<span class="hljs-keyword">max</span> = <span class="hljs-number">10</span>
  }
  # Throughput defines the maximum <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> messages <span class="hljs-keyword">to</span> be
  # processed per actor <span class="hljs-keyword">before</span> the thread jumps <span class="hljs-keyword">to</span> the <span class="hljs-keyword">next</span> actor.
  # <span class="hljs-keyword">Set</span> <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">as</span> fair <span class="hljs-keyword">as</span> possible.
  throughput = <span class="hljs-number">100</span>
}</span>
</code></pre><p>For more options, see the <code>default-dispatcher</code> section of the Configuration.</p>
<p>Then you create the actor as usual and define the dispatcher in the deployment configuration.</p>
<pre><code class="hljs lang-csharp">ActorRef myActor =
  system.ActorOf(Props.Create(<span class="hljs-keyword">typeof</span>(MyUntypedActor)),
    <span class="hljs-string">"myactor"</span>);
</code></pre>
<pre><code><span class="hljs-attribute">akka.actor.deployment {
  /myactor {
    dispatcher </span>=<span class="hljs-string"> my-dispatcher
  }
}</span>
</code></pre><p>An alternative to the deployment configuration is to define the dispatcher in code. If you define the dispatcher in the deployment configuration then this value will be used instead of programmatically provided parameter.</p>
<pre><code class="hljs lang-csharp">ActorRef myActor =
  system.ActorOf(Props.Create(<span class="hljs-keyword">typeof</span>(MyUntypedActor)).WithDispatcher(<span class="hljs-string">"my-dispatcher"</span>),
    <span class="hljs-string">"myactor3"</span>);
</code></pre>
<div class="alert alert-success">
<p><strong>Note</strong><br/>
The dispatcher you specify in <code>WithDispatcher</code> and the dispatcher property in the deployment configuration is in fact a path into your configuration. So in this example it&#39;s a top-level section, but you could for instance put it as a sub-section, where you&#39;d use periods to denote sub-sections, like this: &quot;foo.bar.my-dispatcher&quot;</p>
</div>
<h2 id="types-of-dispatchers">Types of dispatchers</h2>
<p>There are 4 different types of message dispatchers:</p>
<ul>
<li><p>Dispatcher</p>
<ul>
<li>This is an event-based dispatcher that binds a set of Actors to a thread pool. It is the default dispatcher used if one is not specified.</li>
<li>Sharability: Unlimited</li>
<li>Mailboxes: Any, creates one per Actor</li>
<li>Use cases: Default dispatcher, Bulkheading</li>
</ul>
</li>
<li><p>PinnedDispatcher</p>
<ul>
<li>This dispatcher dedicates a unique thread for each actor using it; i.e. each actor will have its own thread pool with only one thread in the pool.</li>
<li>Sharability: None</li>
<li>Mailboxes: Any, creates one per Actor</li>
<li>Use cases: Bulkheading</li>
</ul>
</li>
<li><p>CallingThreadDispatcher</p>
<ul>
<li>This dispatcher runs invocations on the current thread only. This dispatcher does not create any new threads, but it can be used from different threads concurrently for the same actor. See CallingThreadDispatcher for details and restrictions.</li>
<li>Sharability: Unlimited</li>
<li>Mailboxes: Any, creates one per Actor per Thread (on demand)</li>
<li>Use cases: Testing</li>
<li>Driven by: The calling thread (duh)</li>
</ul>
</li>
</ul>
<h3 id="more-dispatcher-configuration-examples">More dispatcher configuration examples</h3>
<p>Configuring a <code>PinnedDispatcher</code>:</p>
<pre><code>my-pinned-dispatcher {
  <span class="hljs-keyword">type</span> = PinnedDispatcher
}
</code></pre><p>And then using it:</p>
<pre><code class="hljs lang-csharp">ActorRef myActor = system.ActorOf(Props.Create(<span class="hljs-keyword">typeof</span>(MyUntypedActor));
    .WithDispatcher(<span class="hljs-string">"my-pinned-dispatcher"</span>));
</code></pre>
<p>Note that <code>thread-pool-executor</code> configuration as per the above <code>my-thread-pool-dispatcher</code> example is NOT applicable. This is because every actor will have its own thread pool when using <code>PinnedDispatcher</code>, and that pool will have only one thread.</p>
<p>Note that it&#39;s not guaranteed that the same thread is used over time, since the core pool timeout is used for <code>PinnedDispatcher</code> to keep resource usage down in case of idle actors. To use the same thread all the time you need to add <code>thread-pool-executor.allow-core-timeout=off</code> to the configuration of the <code>PinnedDispatcher</code>.</p>


								<div class="sky-form boxed">
									<header>Leave a comment</header>
									<div style="padding:12px;">
									<div id="disqus_thread"></div>
					                <script type="text/javascript">
					                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
					                    var disqus_shortname = 'akkanet'; // required: replace example with your forum shortname

					                    /* * * DON'T EDIT BELOW THIS LINE * * */
					                    (function () {
					                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
					                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
					                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
					                    })();
					                </script>
					                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
						            </div>
						        </div>
							</div>

						</div>
						<!-- /LEFT COLUMNS -->



					</div>

				</div>
			</section>
			<!-- /CONTENT -->


			<!-- FOOTER -->
			<footer id="footer">
				<div class="container">

					<div class="row">

						<!-- col #1 -->
						<div class="spaced dark col-md-3">
							<h4>About <strong>Akka.NET</strong></h4>
							<p class="block">
							Akka.NET is a port of the popular <br/>
							Java/Scala framework <a href="http://akka.io">Akka</a> to .NET.<br/>
							<br/>
							This is a community driven port and <br/>
							is not affiliated with <a href="http://typesafe.com">Typesafe</a> who <br/>
							makes the original Java/Scala version.<br/>
							</p>

							<p class="block"><!-- social -->
								<a href="https://www.facebook.com/akkadotnet" class="social fa fa-facebook"></a>
								<a href="http://stackoverflow.com/questions/tagged/akka.net" class="social fa fa-stack-overflow"></a>
								<a href="https://twitter.com/AkkaDotNET" class="social fa fa-twitter"></a>
							</p><!-- /social -->
						</div>
						<!-- /col #1 -->



						<!-- col #3 -->
						<div class="spaced col-md-6 col-sm-4">
							<h4>Recent <strong>Tweets</strong></h4>
							<ul class="list-unstyled fsize13" id="recent_tweets">
							<!--	<li>
									<i class="fa fa-twitter"></i> <a href="#">@John Doe</a> Pilsum dolor lorem sit consectetur adipiscing orem sequat <small class="ago">8 mins ago</small>
								</li>
								<li>
									<i class="fa fa-twitter"></i> <a href="#">@John Doe</a> Remonde sequat ipsum dolor lorem sit consectetur adipiscing  <small class="ago">8 mins ago</small>
								</li>
								<li>
									<i class="fa fa-twitter"></i> <a href="#">@John Doe</a> Imperdiet condimentum diam dolor lorem sit consectetur adipiscing <small class="ago">8 mins ago</small>
								</li>-->
							</ul>
						</div>
						<!-- /col #3 -->
						
						<div class="spaced col-md-3 col-sm-4">
							<h4>Keep <strong>Updated</strong></h4>

							<h4><small><strong>Subscribe to our Newsletter</strong></small></h4>

							
							<!-- Begin MailChimp Signup Form -->
							<div id="mc_embed_signup">
							<form class="input-group" action="//github.us8.list-manage.com/subscribe/post?u=945d2a2edaa89aaabd396bc45&amp;id=5f9a7a993d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
						
								<input type="email" value="" name="EMAIL" class="form-control placeholder required email" id="mce-EMAIL" placeholder="E-mail Address" >
								<span class="input-group-btn">
									<button class="btn btn-primary" type="submit" name="subscribe" id="mc-embedded-subscribe">SUBMIT</button>
								</span>
					
								<div id="mce-responses" class="clear">
									<div class="response" id="mce-error-response" style="display:none"></div>
									<div class="response" id="mce-success-response" style="display:none"></div>
								</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
							    <div style="position: absolute; left: -5000px;"><input type="text" name="b_945d2a2edaa89aaabd396bc45_5f9a7a993d" tabindex="-1" value=""></div>
							    <div class="clear"></div>
							</form>
							</div>
							
							<!--End mc_embed_signup-->

						</div>
					</div>

				</div>

				<hr />

				<div class="copyright">
					<div class="container text-center fsize12">
						<!--Epona theme by <a href="http://www.stepofweb.com" target="_blank" title="bootstrap themes &amp; templates" class="copyright">stepofweb</a> &bull; All Right Reserved &copy; Your Company LLC. &nbsp;
						<a href="page-privacy.html" class="fsize11">Privacy Policy</a> &bull; 
						<a href="page-terms.html" class="fsize11">Terms of Service</a>-->
					</div>
				</div>
			</footer>
			<!-- /FOOTER -->

			<a href="#" id="toTop"></a>

		</div><!-- /#wrapper -->

		<!-- JAVASCRIPT FILES -->
		<script type="text/javascript" src="/assets/plugins/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="/assets/plugins/jquery.isotope.js"></script>
		<script type="text/javascript" src="/assets/plugins/masonry.js"></script>

		<script type="text/javascript" src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="/assets/plugins/magnific-popup/jquery.magnific-popup.min.js"></script>
		<script type="text/javascript" src="/assets/plugins/owl-carousel/owl.carousel.min.js"></script>
		<script type="text/javascript" src="/assets/plugins/knob/js/jquery.knob.js"></script>
		<script type="text/javascript" src="/assets/plugins/flexslider/jquery.flexslider-min.js"></script>

		<!-- REVOLUTION SLIDER -->
		<script type="text/javascript" src="/assets/plugins/revolution-slider/js/jquery.themepunch.plugins.min.js"></script>
		<script type="text/javascript" src="/assets/plugins/revolution-slider/js/jquery.themepunch.revolution.min.js"></script>
		<script type="text/javascript" src="/assets/js/revolution_slider.js"></script>
		<script type="text/javascript" src="/content/jquery-toc.js"></script>


		<script type="text/javascript" src="/assets/js/scripts.js"></script>
		<script type="text/javascript" src="/content/scripts.js"></script>
		<a href="http://www.reactivemanifesto.org/"> <img style="border: 0px currentColor; left: 0px; top: 0px; position: fixed; z-index: 9000;" src="http://www.reactivemanifesto.org/images/ribbons/we-are-reactive-red-left.png"> </a>
	</body>
</html>
